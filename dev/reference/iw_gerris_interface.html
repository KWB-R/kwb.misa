<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Convert data from infoworks output to gerris input format — iw_gerris_interface • kwb.misa</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Convert data from infoworks output to gerris input format — iw_gerris_interface"><meta property="og:description" content="Convert data from infoworks output to gerris input format"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kwb.misa</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/documention.html">documention</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/KWB-R/kwb.misa/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Convert data from infoworks output to gerris input format</h1>
    <small class="dont-index">Source: <a href="https://github.com/KWB-R/kwb.misa/blob/HEAD/R/interface_run.R" class="external-link"><code>R/interface_run.R</code></a></small>
    <div class="hidden name"><code>iw_gerris_interface.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Convert data from infoworks output to gerris input format</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">iw_gerris_interface</span><span class="op">(</span></span>
<span>  <span class="va">interface_input_folder</span>,</span>
<span>  <span class="va">interface_output_folder</span>,</span>
<span>  <span class="va">simulation_name</span>,</span>
<span>  stop_after <span class="op">=</span> <span class="st">""</span>,</span>
<span>  return_output_table <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  infoworks_time_format <span class="op">=</span> <span class="st">"%d/%m/%Y %H:%M:%S"</span>,</span>
<span>  gerris_time_format <span class="op">=</span> <span class="st">"%d.%m.%Y %H:%M"</span>,</span>
<span>  timestep_out <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  skip_hours <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  flow_threshold <span class="op">=</span> <span class="fl">0.003</span>,</span>
<span>  flow_only <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>interface_input_folder</dt>
<dd><p>Folder in which the inforowks output files are
located</p></dd>


<dt>interface_output_folder</dt>
<dd><p>Folder where the gerris input files are saved</p></dd>


<dt>simulation_name</dt>
<dd><p>Either the whole name of the simulation or a unique
part regarding all simulations in the defined folder</p></dd>


<dt>stop_after</dt>
<dd><p>if a number is given, the function returns the data after
thata data processing step. For more information see details</p></dd>


<dt>return_output_table</dt>
<dd><p>If TRUE the output table is returned, otherwise it
is only saved in the speficied table</p></dd>


<dt>infoworks_time_format</dt>
<dd><p>The Inforworks time format default is
"%d/%m/%Y %H:%M:%S". For manual adaption see details of <code><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strptime()</a></code></p></dd>


<dt>gerris_time_format</dt>
<dd><p>The Gerris time format default is
"%d.%m.%Y %H:%M". For manual adaption see details of <code><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strptime()</a></code></p></dd>


<dt>timestep_out</dt>
<dd><p>The timesteps needed for Gerris in minutes
(default is  15)</p></dd>


<dt>skip_hours</dt>
<dd><p>The hours to skip before Gerris input is needed. This is
especially imnportant if infoworks needs a long start-up phase that should
not be passed on the gerris</p></dd>


<dt>flow_threshold</dt>
<dd><p>A threshold underneath which the flow is set to 0 to
avoid negative flows (in m3/s)</p></dd>


<dt>flow_only</dt>
<dd><p>If TRUE, a flow file is sufficient as interface input.
All other available input files will also be processed but no total nitrogen
is calculated that might lead to an error due to missing nitrogen input files</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>One table containing all water quality and overflow data per outlet and
timestamp at which an overflow occurred plus there very first timestemp of
the simulation. One table with statistics per outlet over the whole
simulation time. A log file with messages of the data processing.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>These are the steps within the function:</p><ol><li><p>load data</p></li>
<li><p>set flow to 0 below threshold value</p></li>
<li><p>change timesteps</p></li>
<li><p>outlets that do not have an ID in Gerris are integrated into the closest
vailable outlet in the model</p></li>
<li><p>calculating concentration by parameters mass flow and water flow</p></li>
<li><p>if TKN &lt; NH4-N --&gt; TKN = NH4-N (not done if floe_only = TRUE)</p></li>
<li><p>new table for total Nitrogen (sum of TKN NO2, and NO3)
(not done if floe_only = TRUE)</p></li>
<li><p>Rename Parameters</p></li>
<li><p>Add all Parameters with constant values</p></li>
<li><p>Check if all parameters are within the gerris range between min and max
and round to 3 significant digits</p></li>
<li><p>reshape the data from data per parameter to data per outlet</p></li>
<li><p>add a column with gerris id ("Randbedingung")</p></li>
<li><p>delete all rows without flow (except for the very first time step, and
the event surrounding timesteps)
After that data is aggregated for the "stats" output files</p></li>
<li><p>collect all data in one single table</p></li>
<li><p>change time format</p></li>
<li><p>Save table for use in gerris</p></li>
</ol></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Malte Zamzow.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

